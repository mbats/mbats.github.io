I"ò<p>Continuing the <a href="http://www.eclipse.org/sirius/">Sirius</a> blog <a href="http://melb.enix.org/category/sirius/">posts series</a>, today we will see a small tip: how to create artificial containers in your diagram?</p>

<p>One of the main advantage of Sirius is that the graphical representations are independent from the metamodel‚Äôs structure. This means that you can choose to not respect the containment hierarchy of your model when you display it graphically. This is possible thanks to Sirius being based on <a href="http://www.eclipse.org/sirius/doc/specifier/general/Writing_Queries.html">queries</a>.</p>

<p>In the following example, we define a metamodel of a family:<br />
<img src="https://raw.githubusercontent.com/mbats/sirius-blog/master/artificial-container/blog/images/Metamodel.png" alt="" /></p>

<p>To begin with, we define a <em>Flat</em> diagram, which displays all the members of the family at the same level:<br />
<img src="https://raw.githubusercontent.com/mbats/sirius-blog/master/artificial-container/blog/images/Flat_VSM.png" alt="" /></p>

<p>In the <em>Person</em> mapping, we use the <em>Semantic Candidates Expression</em> to provide which semantic elements must be represented. These expressions returning model elements are called <a href="http://www.eclipse.org/sirius/doc/specifier/general/Writing_Queries.html">queries</a>. To write these queries, there are different languages provided by default in Sirius: specialized interpreters (<code class="language-plaintext highlighter-rouge">var</code>, <code class="language-plaintext highlighter-rouge">feature</code>, <code class="language-plaintext highlighter-rouge">service</code>), Acceleo, raw OCL or Java. Here, we use the <em>feature</em> interpreter to get for a family all the persons referenced by the <code class="language-plaintext highlighter-rouge">members</code> reference. You can easily identify <em>interpreted expressions</em> by their yellow background in the Properties tab of an element.</p>

<p>We create a first diagram which represents the flattened Skywalker family:<br />
<img src="https://raw.githubusercontent.com/mbats/sirius-blog/master/artificial-container/blog/images/Flat.png" alt="" /></p>

<p>The next step is to add a level to model the <em>Family</em> as a container. We create a new <em>Family</em> diagram which contains a <em>Family</em> container mapping and a <em>Person</em> mapping as sub nodes:<br />
<img src="https://raw.githubusercontent.com/mbats/sirius-blog/master/artificial-container/blog/images/Family_VSM.png" alt="" /></p>

<p>The <em>Family</em> diagram is created and all the members are represented inside the Skywalker container.<br />
<img src="https://raw.githubusercontent.com/mbats/sirius-blog/master/artificial-container/blog/images/Family.png" alt="" /></p>

<p>Here we represent graphically the containment reference <code class="language-plaintext highlighter-rouge">members</code>. But what to do if we want to create an <em>artificial</em> container which does not exist in the metamodel as a containment reference?</p>

<p>Let‚Äôs see! Now imagine that we want to add a level to represent <a href="http://en.wikipedia.org/wiki/The_Force_(Star_Wars)">The Force</a> and if the person is related to the dark side or the light side. To do this we create a new <em>ForceSide</em> diagram:<br />
<img src="https://raw.githubusercontent.com/mbats/sirius-blog/master/artificial-container/blog/images/ForceSide_VSM.png" alt="" /></p>

<p>We add a new container to represent the <em>DarkSide</em> of the force :<br />
<img src="https://raw.githubusercontent.com/mbats/sirius-blog/master/artificial-container/blog/images/DarkSide_VSM.png" alt="" /></p>

<p>The dark side must be represented once for each family, the semantic candidate returns <em>var:self</em> which means the current family. As it should contain persons, it is defined as a <em>FreeForm</em> container.</p>

<p>We need to represent, in the Dark Side container, the persons that are from the dark side of the force. So we define a new sub node <em>Person</em> with the Semantic expression set to: <code class="language-plaintext highlighter-rouge">[self.members-&gt;select(p|p.oclAsType(Person).dark)/]</code><br />
This query returns all the members of a family and selects only the <em>Person</em> which has the attribute <code class="language-plaintext highlighter-rouge">dark</code> set to true.</p>

<p><img src="https://raw.githubusercontent.com/mbats/sirius-blog/master/artificial-container/blog/images/Sith_VSM.png" alt="" /></p>

<p>Then we reuse the <em>Person</em> mapping to represent the person in its force side container.</p>

<p>Finally, we do the same for the light side of the force and we create a <code class="language-plaintext highlighter-rouge">LightSide</code> container and the <code class="language-plaintext highlighter-rouge">Person</code> mapping to represent members of the family in this new container who are influenced by the light side: <code class="language-plaintext highlighter-rouge">[not self.members-&gt;select(p|p.oclAsType(Person).dark)/]</code><br />
A new <code class="language-plaintext highlighter-rouge">ForceSide</code> diagram is created in the Skywalker family and we discover that only Darth Vader is from the dark side of the force and that his children are driven by the light side of the force.<br />
<img src="https://raw.githubusercontent.com/mbats/sirius-blog/master/artificial-container/blog/images/ForceSide.png" alt="" /></p>

<p>Thanks to the queries in Sirius, it is easy to create artificial containers which are not related to containment referencers in the metamodel.</p>

<p><em>‚ÄúMay the <strong>Sirius</strong> Force be with you‚Äù</em> <img src="http://melb.enix.org/wp-includes/images/smilies/icon_wink.gif" alt=";)" /></p>

<p>The sample code from this example is available on github: <a href="https://github.com/mbats/sirius-blog/tree/master/artificial-container">https://github.com/mbats/sirius-blog/tree/master/artificial-container</a></p>
:ET