I"È<p>Continuing from the example of our <a href="http://melb.enix.org/sirius/the-tree-layout-secret">previous blog post</a> on House of Cards, weâ€™ll see today how one can customize the elements of diagrams by using pictures.</p>

<h2 id="per-diagram-instance-customization">Per-diagram instance customization</h2>

<p>In a Sirius based editor, the style of each diagram element can be customized. This customization can be applied from:</p>

<ul>
  <li>the tool bar:</li>
</ul>

<p><img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/toolbar.png?raw=true" alt="" /></p>

<ul>
  <li>the <code class="language-plaintext highlighter-rouge">Appearance</code> tab of the property view:</li>
</ul>

<p><img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/appearance.png?raw=true" alt="" /></p>

<ul>
  <li>the <code class="language-plaintext highlighter-rouge">Diagram</code> menu:</li>
</ul>

<p><img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/diagram.png?raw=true" alt="" /></p>

<ul>
  <li>the contextual menu <code class="language-plaintext highlighter-rouge">Format</code>:</li>
</ul>

<p><img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/format.png?raw=true" alt="" /> The elements you can customize are:</p>

<ul>
  <li>container: background color, background style, border size, foreground color, label alignment, label size, label format and workspace image.</li>
  <li>node: border size, color, label alignment, format, position, size and workspace image.</li>
  <li>edge: the folding style, the color, the label alignment, format, position and size, the line and routing style, the size and the target and source arrow.</li>
</ul>

<p>If we set a workspace image on the <em>Influence</em> diagram resulting from the <a href="http://melb.enix.org/sirius/the-tree-layout-secret">tree layout blog post</a>, we are able to see Frank Underwoodâ€™s face instead of a simple white square. <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/set_image_on_existing_diag.png?raw=true" alt="" /> These customizations can be reset using:</p>

<ul>
  <li>the <code class="language-plaintext highlighter-rouge">Reset style customization</code> button available in the <code class="language-plaintext highlighter-rouge">Appearance</code> tab of the property view :</li>
</ul>

<p><img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/appearance_reset.png?raw=true" alt="" /></p>

<ul>
  <li>in the diagram editor tool bar :</li>
</ul>

<p><img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/toolbar_reset.png?raw=true" alt="" /> Thanks to this feature each user can customize existing diagrams in any Sirius based modeler. The problem with this solution is that if you create another diagram, the default style will be applied, and we would no longer see Frankâ€™s beautiful face. This method is only useful to customize a specific instance of a diagram.</p>

<h2 id="using-workspace-image-style">Using workspace image style</h2>

<p>If instead of having customization specific to a given instance, we would like all diagrams of a certain type, what we need to do is to provide the image during the diagram specification phase. In order to get the image on every new diagram, we need to provide it at the diagram specification phase. To do so, after reopening the <code class="language-plaintext highlighter-rouge">houseofcards.odesign</code>, we need to update the <em>Influence</em> diagram description to use a workspace image in a conditional style to represent Frank. <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/conditional_styles_specification.png?raw=true" alt="" /> From now on, everytime an <em>Influence</em> diagram is created, Frankâ€™s and Lindaâ€™s faces will automatically be associated to the relevant diagram elements. <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/conditional_styles.png?raw=true" alt="" /> What is problematic with this solution is that we need to create a conditional style for each character. As there are around 50 different characters in the House of Cards series, it is not a very practical solution.</p>

<h2 id="specify-style-custom-images">Specify style custom images</h2>

<p>Fortunately, Sirius provides another way to achieve that. We want to provide all the images in a specific folder and have Sirius select the right one according to the pictureâ€™s name. This can easily be done by using the <code class="language-plaintext highlighter-rouge">style customizations</code>. We modify our mapping to specify a workspace image style. <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/style_custo_mapping.png?raw=true" alt="" /> We provide a new style customization: <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/style_custo_specification.png?raw=true" alt="" /> And a new property customization by expression: <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/style_custo_property_specification.png?raw=true" alt="" /> All the pictures are stored in an <code class="language-plaintext highlighter-rouge">images</code> folder. <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/style_custo_design_images.png?raw=true" alt="" /> Then we specify that the style to customize is the workspace image previously defined. This style customization must be applied on <code class="language-plaintext highlighter-rouge">PersonWorkspaceImage</code> and we want to customize the <code class="language-plaintext highlighter-rouge">workspacePath</code> property: <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/style_custo_property_specification2.png?raw=true" alt="" /> To retrieve the value of the <code class="language-plaintext highlighter-rouge">workspacePath</code>, we call a Java service <code class="language-plaintext highlighter-rouge">getImage</code> which returns the image path from the person name: <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/style_custo_java.png?raw=true" alt="" /> Finally, when we reopen our example, we get a shinier diagram this time with everybody associated to his picture. <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/style_custo_property.png?raw=true" alt="" /> And now if I update the name of a character, I get automatically the associated picture. John Doe is represented by the default image and we see Zoeâ€™s lovely face. <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/style_custo_update_name.png?raw=true" alt="" /> With the next Sirius 3.0 version, if you use images with a transparent background, the edges will follow the image. <img src="https://github.com/mbats/sirius-blog/blob/master/custo-diag/blog/images/Sirius_3_0_Edges_And_Transparency.png?raw=true" alt="" /> The sample code from this example is available on github:Â <a href="https://github.com/mbats/sirius-blog/tree/master/custo-diag" title="https://github.com/mbats/sirius-blog/tree/master/custo-diag">https://github.com/mbats/sirius-blog/tree/master/custo-diag</a></p>
:ET